<?php use_helper('I18N', 'JqueryUi', 'Application') ?>
<?php
cms_use_stylesheet('register', 'chCmsGuardExtraPlugin');
use_javascript('/chCmsBasePlugin/js/jqueryui_widgets/delay_action.widget.js');
use_javascript('/chCmsBasePlugin/js/jqueryui_widgets/form.widgets.js');
use_javascript('/chCmsGuardExtraPlugin/js/checker.js');
?>
<?php //use_javascript('/chCmsGuardExtraPlugin/js/register.js'); ?>
<div class="container_12 clearfix container" id="register-page">

  <div class="grid_6">
    <div id="signin-content" class="centered-content">
    <h4><?php echo __('Créer un nouveau compte T-resa') ?></h4>
      <?php if ($sf_user->haschCmsGuardExtraProvider()): ?>
        <?php include_partial(sprintf('%sAuthentication/registerForm', $sf_user->getchCmsGuardExtraProvider()->getProvider()), array('form' => $form)) ?>
      <?php else: ?>
        <?php include_partial('chCmsFrontendSignup/registerForm', array('form' => $form)); ?>
      <?php endif; ?>
   </div>
 </div>

<!--HERE 2 WAY : WITH PROVIDER AUTH OR WITHOUT -->
<?php if ($sf_user->haschCmsGuardExtraProvider()): ?>
  <div class="grid_5 prefix_1">
   <div id="signin-link-to-existing-account" class="centered-content">
    <h4><?php echo __('J\'ai déjà un compte T-resa') ?></h4>
    <?php include_component('Associate', 'Associate'); ?>
   </div>
  </div>

  <div class="clear"></div>
 <?php slot('toolbar') ?>
  <div class="ch-toolbar">
    <?php $values = $sf_user->getchCmsGuardExtraProviderFormValues();
          $icon=  sprintf('social-%s-16',strtolower($sf_user->getchCmsGuardExtraProvider()->getProvider()));
    ?>

    <?php echo jui_button_link($values['username'], '@signup_cancel',array('primary-icon'=> $icon, 'secondary-icon' => 'silk-cross-16', 'title' =>'Annuler l\'authentification depuis ce compte')) ?>
  </div>
 <?php end_slot() ?>

<?php else: ?>

 <div class="grid_5 prefix_1">
   <div id="signin-link-to-signup">
        <?php echo image_tag('users/speakvect', 'size=130x155') ?>
    </div>
  </div>
  <?php slot('toolbar') ?>
    <div class="ch-toolbar">
      <?php include_partial('chCmsFrontendAccount/externalAuthentications'); ?>
    </div>
  <?php end_slot() ?>

<?php endif; ?>

</div><!--end register-page-->
<?php slot('title') ?>
 <h3><?php echo __('Inscription') ?></h3>
<?php end_slot() ?>
