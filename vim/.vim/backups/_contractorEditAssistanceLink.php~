<?php
/*
  $current: the current user we are editing the profile of
  $assistant
  $contractor
  $assistantName
  $form
*/
?>
<form action="<?php echo admin_url_for(
                          $group,
                          "assistant_new", 
                          array('contractor_id' => $contractor->getId(), 'assistant_id' => $assistant->getId(), 'current' => $current->getId())) ?>"
      method="POST">
  <?php if ($form->hasGlobalErrors()): ?>
    <?php echo $form->renderGlobalErrors(); ?>
  <?php endif ?>
  <table>
    <tbody>
      <tr>
        <th>
          <?php if ($current->getId() === $contractor->getId()): ?>
              <?php $icon_a = jui_icon('silk-user_green');?>
              <?php $icon_c = jui_icon('silk-user_star');?>
          <?php else: ?>
              <?php $icon_c = jui_icon('silk-user_green');?>
              <?php $icon_a = jui_icon('silk-user_star');?>
          <?php endif; ?>
          <?php echo __('%c_icon% %contractor% accorde ces droits Ã  %a_icon% %assistant%', array(
                            '%assistant%' => $assistant,
                            '%contractor%' => $contractor,
                            '%c_icon%' => $icon_c,
                            '%a_icon%'  => $icon_a)) ?>
        </th>
        <th class="actions-cell">
          <p class="button-spacer">
            <?php echo $form->renderHiddenFields(); ?>
            <?php echo jui_submit_button('Save', array('onclick' => 'Tresa.Contractors.rightsModifySubmitForm(this); return false;')); ?>

            <?php echo jui_link_to_function('Annuler', 
                          'Tresa.Contractors.rightsCancelEdit(this)',
                          array('icon' => "silk-bullet_cross",
                                'href' => admin_url_for(
                                              $group,
                                              "assistant_show", 
                                              array('contractor_id' => $contractor->getId(), 'assistant_id' => $assistant->getId(), 'current' => $current->getId())))); ?>
          </p>
        </th>
      </tr>
      <tr>
        <th><?php echo $form['access_freebusy']->renderLabel(); ?></th>
        <td>
          <?php echo $form['access_freebusy']->renderError(); ?>
          <?php echo $form['access_freebusy']->render(); ?>
        </td>
      </tr>
      <tr>
        <th><?php echo $form['access_event']->renderLabel(); ?></th>
        <td>
          <?php echo $form['access_event']->renderError(); ?>
          <?php echo $form['access_event']->render(); ?>
        </td>
      </tr>
      <tr>
        <th><?php echo $form['access_contact_public']->renderLabel(); ?></th>
        <td>
          <?php echo $form['access_contact_public']->renderError(); ?>
          <?php echo $form['access_contact_public']->render(); ?>
        </td>
      </tr>
      <tr>
        <th><?php echo $form['access_contact_protected']->renderLabel(); ?></th>
        <td>
          <?php echo $form['access_contact_protected']->renderError(); ?>
          <?php echo $form['access_contact_protected']->render(); ?>
        </td>
      </tr>
    </tbody>
  </table>
</form>
