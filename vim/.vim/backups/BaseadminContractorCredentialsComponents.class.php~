<?php

/**
 * Base components for the chCmsAdminContractorPlugin adminContractorCredentials module.
 * 
 * @package     chCmsAdminContractorPlugin
 * @subpackage  module-adminContractorCredentials
 * @author      Julien Muetton <julien_muetton@carpe-hora.com>
 * @version     SVN: $Id$
 */
abstract class BaseadminContractorCredentialsComponents extends chCmsAdminPanelComponents
{
  /**
   * the preexecute function
   *
   * @return void
   * @author Julien Muetton <julien_muetton@carpe-hora.com>
   **/
  public function preExecute()
  {
    AdminContractorEntityTools::preExecuteCredentials($this->getRoute(),$this->getUser());
  }

  /**
   * entry point for Index action
   *
   * @param sfWebRequest $request the user request
   * @return 
   */
  public function executeIndex(sfWebRequest $request)
  {
    $this->preExecute();

//    $contractors = $this->getRoute()->getObjects();
$contractors = $this->getUser()->getSelectedCompany()->getContractors();

    $this->contractorNames = AdminContractorEntityTools::getCredentialListHeader($contractors);
    
    $this->form = new DefaultContractorCredentialsForm(null, array('contractors' => $contractors));

  }

  /**
   * entry point for Default action
   *
   * @param sfWebRequest $request the user request
   * @return 
   */
  public function executeDefault(sfWebRequest $request)
  {
    $this->preExecute();

    $this->form = new CompanyDefaultRightsForm();
  }
}
